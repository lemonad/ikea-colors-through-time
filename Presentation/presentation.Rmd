---
title: "IKEA catalogs and colors through time"
author: "Jonas Nockert"
date: "2021-01-13"
output:
  ioslides_presentation:
    logo: SU_logo_CMYK.png
    incremental: TRUE
    css: slides.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(grid)
library(gridExtra)
library(magick)
library(magrittr)
library(reticulate)

# Use the offical IKEA typeface!
library(gfonts)
use_font("noto-sans", "../report/fonts/css/noto-sans.css")

source("../Report/colors.r")
source("../Report/plotting.r")
```


```{r, cached = TRUE, include = FALSE}
years <- 1950L:2021L
total_pages <- 0L
total_pixels <- 0L
for (year in years) {
  load(paste0("../Report/data/stats", year, ".RData"))
  total_pages <- total_pages + length(stats_list)
  total_pixels <- total_pixels +
    sum(map(stats_list, function(x) x$n_pixels) %>% unlist)
}
```

## 72 √ÖR, 72 KATALOGER {data-background=../report/images/ikea-frontpage-plot.png data-background-size=cover}


## <br/><br/><br/><br/><br/><br/>`r total_pages` SIDOR<br/>`r total_pixels` PIXELS {data-background=../report/images/page2-1969.jpg data-background-size=cover}


## EN BILDS MEDELF√ÑRG

```{r, cache = TRUE, fig.height = 4.5, echo = FALSE}
im <- image_read("../Report/images/page50-1989.jpg") %>%
  # Point resizing method produces visually bad results but does not introduce
  # interpolated colors that was not part of the image from the start.
  image_resize("25%", filter = "Point")
im_rgb <- im %>%
  image_data("rgb") %>%
  as.numeric()
d <- dim(im_rgb)
im_rgb <- array_reshape(im_rgb, c(d[[1]] * d[[2]], 3))
mean_color <- colMeans(im_rgb)
plot_theme(im, matrix(mean_color, ncol = 3))
```


## F√ÑRGTEMA VIA K-MEANS-KLUSTRING

```{r, cache = TRUE, fig.height = 4.5, echo = FALSE}
clustering <- kmeans(im_rgb, centers = 6, iter.max = 50)
plot_theme(im, clustering$centers)
```


## KONVEXT H√ñLJE AV EN BILD {data-background=../report/images/convex-hull-tan-2016.png data-background-size=contain}


## F√ÑRGTEMA VIA KONVEXT H√ñLJE

```{r, cache = TRUE, fig.height = 4.5, echo = FALSE}
color_theme <- get_theme_colors_from_image(
  "../Report/images/page50-1989.jpg",
  n_colors = 6
)
plot_theme(im, color_theme)
```


## TROR NI DET FUNGERADE? :) {.flexbox .vcenter data-background=../report/images/page49-2002.jpg data-background-size=cover}

<div class="large-outline">
üëç JA
<br/><br/><br/>
üëé NEJ
</div>
